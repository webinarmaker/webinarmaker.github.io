# WebinarMaker

## WebinarMakerの概要

WebinarMakerは、録画されたセミナー動画を使用して、定期的かつ自動でウェブセミナーを開催できるサービスです。
一般的なセミナーのように、開催時間になるとセミナー動画の再生が始まります。
セミナー途中の時間であっても、その時間に基づいて動画は途中から再生され、ウェビナーのように振る舞います。
動画が最後まで再生されると、セミナー終了となります。

WebinarMakerではYouTubeの動画を使用します。
セミナー用の動画を撮影および編集してYouTubeに投稿し、そのYouTubeのURLをWebinarMakerに設定します。
ウェビナーに申し込みをした申し込みユーザはYouTube Player APIを使った視聴用ページから視聴できます。

WebinarMakerはウェビナーの申込者に対して独自ドメインの定型メールメッセージを送信できます。
ウェビナー開始前や後に、自由なメールメッセージを送信して、関連情報や特典を提供します。

## 開始方法

WebinarMakerを使って、ウェビナーを実施する基本的なステップを開始します。

### ステップ1: WebinarMakerにログイン

WebinarMakerのログイン画面(https://webinarmaker.jp/signin)にアクセスして、ログイン情報を入力します。
ログイン情報はアカウントが作成された時に送信されたメールに記載されています。

### ステップ2: ウェビナーの作成

毎日13時と19時に開催されるウェビナーを作成します。

**ウェビナーを作成するには**

  1. WebinarMakerにログインした状態で、 https://webinarmaker.jp/dashboard にアクセスします。
  2. 画面右下の「ウェビナー作成」を選択します。
  3. タイトルにウェビナーのタイトルを入力します。
  4. ビデオにはウェビナー動画のYouTube URL(https://www.youtube.com/watch?v=XXXXXXXXXXX)を入力します。
  5. スケジュールに `0 13,19 * * ?` を入力します。
  6. 「作成」を選択します。
  7. ウェビナーが作成され、ウェビナーの管理画面に遷移します。

### ステップ3: タグの作成と申込みフォームの掲載

作成したウェビナーに対して、申し込みユーザから申し込みを受付けるために、タグを作成してフォームを表示します。
申し込みフォームはランディングページ等に表示させるために、HTMLタグを発行します。

HTMLタグから申し込みフォームを表示するときは、掲載されるページのオリジンを予め指定します。
申し込みフォームは指定したオリジンのページでのみ表示されます。
オリジンの詳細は[同一オリジンポリシー - Web セキュリティ | MDN](https://developer.mozilla.org/ja/docs/Web/Security/Same-origin_policy)を参照してください。

**タグを作成して、申し込みフォームを表示するには**

  1. ウェビナーの管理画面から「タグを作成する...」を選択します。
  2. タグを識別するための名前と、タグが表示されるページのオリジンを入力します。
  4. 「作成」を選択します。
  5. タグが作成され、ウェビナー管理画面のタグが更新されます。
  6. 作成されたタグにある、「タグを表示」を選択します。
  7. 表示されたHTMLのタグをコピーして、掲載ページにペーストします。
  8. 掲載ページにアクセスして、該当する箇所に申し込みフォームが表示されます。

### ステップ4: 申し込みユーザによるウェビナーの申し込み

ステップ3まではアカウントによるウェビナーのセットアップ手順を示しました。
ステップ4とステップ5は、ウェビナーに参加を申し込むユーザによるステップを示します。

ウェビナーに申し込むユーザは、申し込みフォームが掲載されたページから、フォームを入力して申込みを完了できます。
申し込みフォームには名前とメールアドレス、ウェビナーの参加日時を入力します。
申込みが完了すると、入力されたメールアドレス宛にウェビナーを視聴するページのURLを含むサンクスメールが送信されます。

### ステップ5: 申し込みユーザのウェビナー視聴

前のステップで送信されたサンクスメールの中に、視聴ページのURLが掲載されています。
申し込みユーザは申し込みをした内容に基づいた開催時間にウェビナー動画を視聴できます。
ウェビナー開催前は、開催までの時間が表示され、開催時間になると自動で動画が再生されます。

### ステップ6: ウェビナーの申し込みユーザ管理

ステップ6では再びアカウントによるステップに戻ります。
ステップ4およびステップ5により、申し込みされたユーザを確認します。

**ウェビナーに申し込みしたユーザを確認するには**

  1. WebinarMaker管理画面より、ウェビナーのページにアクセスします。
  2. ページ上部の「申込みユーザ」を選択します。
  3. 開始日および終了日を選択して、確認したい期間を指定します。
  4. 指定した期間内にウェビナーを視聴する申し込みユーザが表示されます。

以上がWebinarMakerを用いたウェビナーの実施フローです。
ウェビナーの詳細な設定項目を使用すれば、振る舞いを変更することができます。
また、独自ドメインによるメールの配信機能も提供しています。
詳細は各セクションを参照してください。

## アカウントの設定

WebinarMakerのアカウントは複数のウェビナーを運用できます。
すべてのウェビナーに共通した、ウェビナー主催者としてアカウントの設定を行います。

アカウントの設定画面はWebinarMakerログイン後の管理画面において、右上のアカウント名を選択して表示します。
アカウントの設定は「アカウント情報」と「メール送信設定」の２つの画面があります。
メール送信設定は「独自ドメインによるメール配信」に必要な設定です。

### アカウント情報

  1. `アカウント名` アカウントの名前を設定します。
     これはこのアカウントで作成されるすべてのウェビナーの主催者名として使用されます。
  2. `メールアドレス` アカウントに紐付いたメールアドレスを設定します。
     ログイン情報のユーザIDを表します。
  3. `申し込みユーザから連絡用メールアドレス` ウェビナーに申し込みをした申込みユーザがウェビナー主催者に連絡するためのメールアドレスを設定します。
     申し込みユーザに対して送信されるサンクスメールに記載されます。

### パスワード更新

アカウントにログインするパスワードを変更できます。
現在のパスワードを入力した上で、新しいパスワードを入力して更新します。

### メール送信設定

メール送信設定は、独自ドメインによるメール配信機能を使用する上で、必要なメールの送信情報を設定します。
ウェビナーに設定したメール配信は、申し込みユーザに対して独自のメールメッセージを独自のメールアドレスから送信します。
送信元となるメールアドレスと、そのメールアドレスからメールを送信するSMTP情報を設定します。
なお、この設定はアカウントが作成したすべてのウェビナーのメール配信に使用されます。

  1. `差出人メールアドレス` メール配信の差出人メールアドレス( FROM )を指定します。
     これは `差出人名 <from@example.com>` のようにRFC 5322にあった形式で入力できます。
  2. `SMTPホスト名`、`SMTPポート番号`、`SMTPユーザ名`、`SMTPパスワード` 差出人メールアドレスからメールを送信するSMTP情報を指定します。
  3. `SSLを使用する` メールを送信する際にSSLを使用するかを指定します。

テスト送信は、メールの送信設定がメールを送信するために正しく設定されているかをテストします。
テストメールはメール送信設定による差出人からアカウントのメールアドレスに送信されます。
「テストメールを送信する」を選択してテストメールを送信して、アカウントのメールアドレス宛にテストメールが送信されていることを確認してください。
なお、テストメールの送信は、メール送信設定より更新を選択し、情報を更新した上で行います。

## ウェビナーの設定

WebinarMakerではウェビナーを運用するにあたり、振る舞いを変更できるオプションが用意されています。
開始方法のセクションで説明した基本的な流れで触れていない項目を説明します。

### ウェビナーの基本設定項目

ウェビナーの作成および、作成済みのウェビナーに対する編集で設定できる項目を説明します。

  1. `タイトル` ウェビナーのタイトルを設定します。
  2. `説明` ウェビナーの説明文を設定します。
     これは視聴用ページに常に表示されます。
     ウェビナーの概要や趣旨などを記述できます。
  3. `ビデオ` 録画済みのウェビナー動画を設定します。
     現在サポートされている動画はYouTubeに投稿された動画のみです。
     動画のページURLを入力します。
     一般的にYouTubeのURLは `https://www.youtube.com/watch?v=XXXXXXXXXXX` のような形式をしています。
  4. `電話番号の取り扱い` 申込ユーザがウェビナーを申し込む歳に、電話番号の取り扱いを設定します。
     「非表示」は申し込みフォームから電話番号の入力フィールドが表示されません。
     「表示」は申し込みフォームに電話番号の入力フィールドが表示されますが、入力は任意として扱います。
     「必須」は申し込みフォームに電話番号の入力フィールが表示され、入力を必須として扱います。
  5. `申込後リダイレクトURL` 申し込みが完了したあと、指定したページへのリダイレクトを設定できます。
     フォーム入力後、「申し込み」を選択すると、フォーム掲載ページから申込後リダイレクトURLに遷移します。
  6. `視聴後リダイレクトURL` ウェビナーの視聴が完了したあと、指定したページへのリダイレクトを設定できます。
     ウェビナーの動画終わると、自動で視聴後リダイレクトURLに遷移します。
  7. `タイムゾーン` ウェビナーの開催時間を決定するタイムゾーンを設定します。
     ウェビナーのスケジュールおよび開催時間はこのタイムゾーンで決定しています。
     現在サポートされているタイムゾーンは日本時間のみです。
  8. `スケジュール` ウェビナーの定期的な開催日時を指定します。
     スケジュールの入力方法に関する詳細は[スケジュールの入力方法](#スケジュールの入力方法)を参照してください。
  9. `申込可能開始日数` と `申込可能終了日数` は申し込みできる日時を制限するための期間を設定します。
     これは省略可能です。
     詳細は[申込日時の制限](#申込日時の制限)を参照してください。

### スケジュールの入力方法

スケジュールには空白で区切られた6つのフィールを入力します。
フィールドは左から順に、分、時間、日、月、曜日、年を表します。
曜日は`1`が日曜日で、`7`が土曜日を表します。
なお、年は省略可能です。

| フィールド | 値        | ワイルドカード |
| ---------- | --------- | -------------- |
| 分         | 0-59      | , - * /        |
| 時間       | 0-23      | , - * /        |
| 日         | 1-31      | , - * ? / L W  |
| 月         | 1-12      | , - * /        |
| 曜日       | 1-7       | , - * ? L #    |
| 年         | 1970-2199 | , - * /        |


ワイルドカードの詳細は次のとおりです

  * ワイルドカード `,` は追加の値を指定します。時間フィールドで `13,19` は13時と19時を指定します。
  * ワイルドカード `-` は範囲を指定します。日フィールドで `1-14` は1日から14日を指定します。
  * ワイルドカード `*` はすべての値を指定します。月フィールドで `*` を指定すると毎月の指定です。
    ただし、`*` を日フィールドと曜日フィールドで同時に指定することはできません。
    片方を`*`に指定した場合、他方は`?`を指定します。、
  * ワイルドカード `/` は増分を指定します。日フィールドで`1/3`は1日、4日、7日・・・と指定します。
  * ワイルドカード `L` は月または週の最終日を指定します。
  * ワイルドカード `W` は平日を指定します。
  * ワイルドカード `#` は月の中で曜日の回数を指定します。たとえば`3#2`は月の第２火曜日を指定します。3は火曜日を表し、2は月の中で第2を表します。

### 申込日時の制限

ウェビナーが開催される開始時間およびその申込日時はスケジュールに従って、決定されます。
例えば、スケジュールが `0 19 * * ?` のように設定すると、毎日19時のウェビナーを申し込みできる日時が決定します。
申し込みフォームでは現在より将来の日時が表示および選択できます。

申込日時の制限機能は申し込みフォームに表示されるウェビナー開始の候補日時を日単位で制限できます。
これはスケジュールが指定された制限期間に限定します。
制限期間は現在日から日数単位で、開始日数と終了日数で設定します。

先の例では、この制限期間を設定しない場合、将来時間に限って本日の19時が申込可能となります。
現在時刻が18時であれば本日の19時が表示されますが、20時であれば本日の19時は表示されません。
これに対し、制限期間の開始日数を設定して、現在日から申込可能な最短の日数を制限します。
開始日数を`1`にすると、申込可能な日時が1日後（明日）以降に制限されます。
本日の時間が何時であれ、本日の19時は選択できず、明日の19時が最初の候補日時となります。
また同様に、終了日数も現在日から申込可能な最長日数を制限できます。

この制限期間はウェビナーの設定画面で設定できます。

### タグ

タグはウェビナーに申し込みをするためのフォームを表示する機能を持つHTMLタグを生成します。
このタグはフォームを掲載するページに貼り付けて、既存のサイトにウェビナーの申し込み機能を統合します。

このタグは掲載するページのオリジン毎に作成します。
指定したオリジンのタグは、同じオリジンの掲載ページやサイトで表示できます。
異なるオリジンでは機能しません。
これはウェブのセキュリティにおいて、同一オリジンポリシーと似た考え方に基づいて実装されています。

オリジンとはスキーム、ドメインおよびポート番号からなるURLの一部です。
例えば、`https://example.com/dir/to/page.html`のオリジンは`https://example.com`です。
`/dir/to/page.html`はいかなる有効なURLであっても同じオリジンです。
一方`http://example.com`はスキーム(`http://`)の違いから異なるオリジンとなります。
オリジンの詳細は[同一オリジンポリシー - Web セキュリティ | MDN](https://developer.mozilla.org/ja/docs/Web/Security/Same-origin_policy)を参照してください。

タグは同一のウェビナーにおいて、申し込みフォームを掲載するページのオリジン毎に複数作成できます。
タグは名前と対応するオリジンを入力して作成します。

タグの名前は識別しやすい名前を自由につけることができます。
申し込みユーザはどのタグによって表示されたフォームから申し込みをしたかを、タグの名前から判断できます。
つまりウェビナーに対する申し込みの経路を特定するために、タグを分けて掲載する運用ができます。

なお、オリジンの指定は申し込みフォームのセキュリティを考慮した制限です。
同じオリジンを指定した複数のタグを作成することもできます。

#### フォームのデザイン

タグの作成および設定画面では、そのタグにより表示される申し込みフォームの見た目を変更できる設定項目があります。
「申し込みキャプション」は申し込みのボタンの表示テキストを変更できます。

また「フォームのCSS」は申し込みフォーム内で適用されるCSSを設定できます。
これは見た目を大きく変更できる高度なオプションです。
フォームには、CSSによるデザインを実装するために、次に示すidが設定されています。
「フォームのCSS」ではこれらのidをセレクタとして使用できます。

  * `gi_name`
  * `tf_name`
  * `gi_email`
  * `tf_email`
  * `gi_play_at`
  * `tf_play_at`
  * `gi_submit`
  * `submit`

### 申し込みユーザ

申し込みユーザはウェビナー管理画面の中で確認できます。
ウェビナー開催日時が指定した開始日および終了日の範囲で絞って表示されます。
また、このデータはUTF-8でエンコードされたCSV形式でダウンロードできます。

確認できる項目は次のとおりです。

| 項目             | csv項目名    | 説明                           |
| ---------------- | ------------ | ------------------------------ |
|                  | `id`         | 申し込みユーザのID             |
|                  | `webinar_id` | ウェビナーのID                 |
| タグ名           | `tag_name`   | 申し込みをしたフォームのタグ   |
| 名前             | `name`       | 申し込みユーザの名前           |
| メール           | `email`      | 申し込みユーザのメールアドレス |
| 電話番号         | `phone`      | 申し込みユーザの電話番号       |
| 申込日時         | `created_at` | 申し込みされた日時             |
| セミナー開催日時 | `play_at`    | 申し込みされた開催日時         |
| 視聴情報         | `viewed`     | 現在の視聴情報                 |

CSVの視聴情報は`100`が視聴ありを表します。

## 独自ドメインによるメール配信

**[TODO]**
